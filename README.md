# Animal Learning

## UI actions + icons

### Animal card actions

The main interaction surface is `src/components/AnimalCard.jsx`:

- Clicking the card plays the **simple** fact audio.
- Right-clicking the card plays the **current fact level**:
  - Simple level => simple fact
  - Detailed level => detailed fact
- The three on-card icon buttons are:
  - **Name**: speaker icon (plays `*_name.mp3`)
  - **Simple fact**: sparkle icon (plays `*_fact_simple.mp3`)
  - **Detailed fact**: book icon (plays `*_fact_detailed.mp3`)

### Animal detail modal actions

The detail modal is `src/components/AnimalDetailModal.jsx`.
It includes three buttons with matching icons:

- **Name**
- **Simple**
- **Detailed**

### Mode toggles

Mode is determined by two contexts:

- `src/contexts/ThemeContext.jsx` (toy vs real)
- `src/contexts/FactLevelContext.jsx` (simple vs detailed)

The combined "Kid" vs "Education" toggle lives in `src/components/Header.jsx`:

- **Kid Mode** = toy theme + simple facts
- **Education Mode** = real theme + detailed facts

## Audio file naming + lookup

Asset paths are generated by `src/utils/slugify.js`:

- Name audio: `public/assets/audio/names/<animalId>_name.mp3`
- Simple fact audio: `public/assets/audio/facts/<animalId>_fact_simple.mp3`
- Detailed fact audio: `public/assets/audio/facts/<animalId>_fact_detailed.mp3`
- Legacy fallback: `public/assets/audio/facts/<animalId>_fact.mp3`

## Simple fact generation workflow (recommended)

ElevenLabs is the expensive step. The recommended workflow is:

### Step 1: Generate and validate scripts with GPT only (cheap)

This writes `src/data/simple_scripts.json` and does **not** call ElevenLabs:

```powershell
python .\scripts\generate_natural_audio_simple.py --write-simple-scripts --allow-invented-simple --batch-size 10
```

You can run a smaller test slice:

```powershell
python .\scripts\generate_natural_audio_simple.py --write-simple-scripts --allow-invented-simple --batch-size 10 --start 1 --limit 30
```

### Step 2: Generate MP3s from the approved scripts (expensive)

Generate missing only:

```powershell
python .\scripts\generate_natural_audio_simple.py --only-simple --simple-openai --use-simple-scripts .\src\data\simple_scripts.json --batch-size 10
```

Overwrite all simple MP3s:

```powershell
python .\scripts\generate_natural_audio_simple.py --only-simple --simple-openai --use-simple-scripts .\src\data\simple_scripts.json --batch-size 10 --redo-all
```

### If the run is interrupted

If the script is stopped, just re-run the same command.

If lock files remain and the generator is not running:

```powershell
Remove-Item .\public\assets\audio\.locks\*.lock
```

## Notes

- The generator enforces a kid-friendly structure and avoids leading pause tags in the text so audio starts immediately on button press.
- Facts come from a merge of:
  - `src/data/facts_clean.json`
  - `src/data/animals.json` (fallback, broader coverage)
